
ジョイスティック状態の記録
==========================

モーションキャプチャアイテムは、パッシブマーカの記録と同時にジョイスティック状態も記録します。ここでは、ジョイスティック状態の記録の仕方を説明します。

ジョイスティック状態の記録の設定
--------------------------------

シミュレーションの実行主体となるモーションキャプチャアイテムを生成します。既に対象とするボディの子アイテムとしてモーションキャプチャアイテムを配置している場合はこの手順は不要です。
メインメニューの「ファイル」-「新規」-「モーションキャプチャ」を選択して生成してください。生成したモーションキャプチャアイテムは、対象とするボディの子アイテムとして配置します。

次に、以下の手順でモーションキャプチャアイテムの設定を変更してください。

1. アイテムツリービュー上で「MotionCapture」を選択する。
2. プロパティビュー上の「デバイス」で任意のジョイスティックのデバイス名を指定する。

モーションキャプチャアイテムの設定の詳細は以下のとおりです。

.. list-table::
  :widths: 20,12,8,75
  :header-rows: 1

  * - パラメータ
    - デフォルト値
    - 単位
    - 意味
  * - デバイス
    - /dev/input/js0
    - \-
    - 任意のジョイスティックのデバイス名を指定する。

シミュレーションの実行
----------------------

シミュレーションバーから通常通りシミュレーションを実行してください。シミュレーションを開始すると"Motion"以下にジョイスティック状態を記録する子アイテム「JoystickSeq-<date>」がアイテムツリービューに登録されます。
ここで<date>は日時のサフィックスです。

ジョイスティック状態のファイル出力
----------------------------------

以下の手順で記録したジョイスティック状態をファイル出力します。

1. シミュレーション実行後に自動生成されたアイテム「JoystickSeq-<date>」を選択する。
2. 「メニュー」-「ファイル」から「選択したアイテムのエクスポート」を選択する。
3. 表示されるダイアログにファイル名を入力し、「保存」ボタンを押す。

なお、出力したファイルには、ジョイスティック状態が全スティック-全ボタンの順番で記録されます。
（例えば、スティック（Axis）が8入力、ボタン(Button)が13入力のジョイスティックを使用している場合は、Axis-0, Axis-1, ..., Axis-7, Button-0, Button-1, ..., Button-12の順番で記録されます。）

ジョイスティック状態のグラフ表示
--------------------------------

以下の手順で記録したジョイスティック状態をグラフ表示できます。

1. 「メニュー」-「表示」-「ビューの表示」から「Multi Value Seq」を選択する。
2. グラフ表示を行うアイテム「JoystickSeq-<date>」を選択する。
3. Multi Value Seqビューの左側に表示されている数字を選択する。

Multi Value Seqビューの左側に表示されている数字は、ジョイスティックの各スティック・ボタンに対応しており、全スティック-全ボタンの順番で割り当てられています。
（例えば、スティック（Axis）が8入力、ボタン(Button)が13入力のジョイスティックを使用している場合は、Axis-0, Axis-1, ..., Axis-7, Button-0, Button-1, ..., Button-12の順番で数字が割り当てられ、0から7はスティック、8から20はボタンを表します。）